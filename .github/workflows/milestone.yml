name: Create new milestone
# Create a milestone by using the most recent tag and incrementing a minor version
on: 
  # Triggers when pull requests to master are closed
  pull_request:
    types: [open]
    branches:
      - master
jobs:
  create_milestone:
    # Run job only if the closed pull request was merged
#     if: github.event.pull_request.merged == true
    steps:
      - uses: actions/checkout@v1
      - name: 'Get Previous tag'
        id: previoustag
        uses: 'WyriHaximus/github-action-get-previous-tag@master'
        env:
          GITHUB_TOKEN: '${{ secrets.GITHUB_TOKEN }}'
      - name: 'Get next minor version'
        id: semvers
        uses: 'WyriHaximus/github-action-next-semvers@master'
        with:
          version: ${{ steps.previoustag.outputs.tag }}
      - name: 'Create new milestone'
        id: createmilestone
        uses: 'WyriHaximus/github-action-create-milestone@master'
        with:
          title: ${{ steps.semvers.outputs.v_minor }}
        env:
          GITHUB_TOKEN: '${{ secrets.GITHUB_TOKEN }}'
